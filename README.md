# 1p1.io
Содержание
1. Внутренняя структура
2. Сборка, таски, подключение модулей и компонентов
3. Библиотеки
4. Компоненты и примечания

# Внутренняя структура
--------------------------------------------
Путь/Название файла  | Содержание файла
---------------------|----------------------
build/                            | конфиги webpack
dist/                             | скомпилированные файлы и ассеты
src/                              | исходные файлы
src/css/                          | скомпилированный css подключаемых модулей
src/fonts/                        | шрифты
src/img/                          | изображения
src/js/                           | пользовательский js + postss.config
src/scss/utils/fonts.scss         | подключаемые шрифты 
-----------------/libs.scss       | библиотеки
-----------------/mixins.scss     | миксины
-----------------/typography.scss | общие типографские размеры и обертки заголовков
-----------------/vars.scss       | кастомизируемые переменные + переменные библиотек
src/scss/main.scss                | общий файл подключения scss + общие правила
src/templates/compontents/        | компоненты
-----------------/layout/         | шаблоны типовых страниц
-----------------/pages/          | страницы
src/video/                        | видеофайлы
src/index.js                      | общий файл подключения .js, модулей и .twig
src/index.twig                    | шаблон главной страницы проекта

# Сборка, таски, подключение модулей и компонентов
Сборка осуществляется в `webpack`. Перед сборкой рекомендуется установить модули через `npm i`.

`npm run dev` - таск разработки

`npm run build` - таск компиляции

Подключение `.js` для библиотек, компонентов, модулей осуществляется в `src/js/index.js`

Подключение `.scss` для библиотек, модулей осуществляется в `src/scss/utils/libs.scss`

Подключение `.scss` компонентов осуществляется в `src/scss/main.scss`

Подключение `.css` осуществляется в `src/scss/utils/libs.scss`, предварительно поместив скомпилированный `.css` в `src/css/`

Подключение шаблонов `.twig` **для страниц** осуществляется в `src/js/index.js`

# Библиотеки
1) [bootstrap 4](https://www.npmjs.com/package/bootstrap) - `.scss` для компиляции кастомной сетки проекта. Выборочно подключены дополнительные `.scss` модули

2) [jQuery](https://www.npmjs.com/package/jquery)

3) [fancybox 3](https://www.npmjs.com/package/@fancyapps/fancybox)

4) [hamburges](https://www.npmjs.com/package/hamburgers) by Jonathan Suh

5) [inputmask](https://www.npmjs.com/package/inputmask)

# Компоненты и примечания

В `src/templates/compontents/` у каждого компонента есть общая папка. Иерархия от общего к частному. У каждого компонента есть отдельный `.twig` и `.scss` файл, а, например, у слайдеров, еще и `.js`

-----------------------------------
header.twig
---
Шапка сайта. В шаблон введено несколько переменных:

`{{ headerType }}` - устанавливает тип шапки. Принимает следующие значения:
1. --white - непрозрачная шапка на белом фоне
2. --transparent - прозрачная шапка для лендингов
3. --no-toggle - не изменять фон при скролле
4. --toggle - изменять фон шапки при скролле

Т.е. для лендингов `{% set headerType = "--transparent --toggle" %}` необходимо для того, чтобы при начале скролла фон шапки с прозрачного менялся на белый и обратно в наивысшей точке. 

Для остальных страниц - `{% set headerType = "--white --no-toggle" %}`

`{{ userStatus }}` - вариант шапки:
1. `--authorised` - для залогиненного пользователя
2. `--unauthorised` - для незалогиненного пользователя

В первом случае скрывается в шапке (для бокового меню пока не реализовано)  кнопка "Войти" и отображается дропдаун с аватаром

Формы
---

`form-popup-macro.twig`  - файл макросов инпутов. В настоящий момент макросы используются для форм логина, регистрации и мобильных версиях страниц логина, регистрации.

На **ВСЕХ** формах отключен сабмит в скриптах или инлайново в целях демонстрации ошибок валидации на фронте или других эффектов.

Для формы регистрации и логина установлен класс `validate` и атрибут `novalidate` для валидации на фронте. (см. `js/common.js`*//custom validation*). 
Для инпутов, не прошедших валидацию, скриптом раздается класс `is-invalid` для отображения текста ошибки под ними. Для формы после валидации устанавливается класс `was-validated` (на всякий случай :D )

Для формы подписки при успешной валидации устанавливать класс `is-subscribed` для отображения плашки с уведомлением о подписке.

news-landing.twig
---
В макете глвной страницы проекта, в разделе новостей отрывок отображается с обрезанием до троеточия на конце.
Проблема в том, что существующее css свойство не работает в Firefox. Поэтому, обрезать необходимо не сервере, после чего в `news-landing.scss:115` удалить следующие свойста и пересобрать css:
```css
display: -webkit-box;
-webkit-line-clamp: 3;
-webkit-box-orient: vertical;
```
В текущем варианте отрывок обрезается до 3х строк

---
P.S. быстрая связь - Telegram: `@skeev2709`
